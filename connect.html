<body style="background-color:#EA0C94">
    <div id="portraitOnlyOverlay" aria-hidden="true"><p>Please rotate your device to portrait mode to view this website.</p></div>
    <div class="wrapper">
        <div class="imageContainer4">
            <header>
                <div id="topHeader">
                    <div>Tobar<span class="multi">MediaDesign</span></div>
                    <div id="copyright-year">©2026</div>
                </div>
            </header>
            <main>
                <section>
                    <div class="formplatform">
                    </div>
                    <div><img id="chatbubble" src="images/chat.png"></div>
                    <div><img id="chatbubble2" src="images/chat.png"></div>
                    <div><img id="chatbubble3" src="images/chat.png"></div>
                    <div><img id="chatbubble4" src="images/chat.png"></div>
                    <div><img id="chatbubble5" src="images/chat.png"></div>
                    <div><img id="chatbubble6" src="images/chat.png"></div>
                </section>
                <form id="contact_form" method="POST" action="sendform.php">
                    <table>
                        <tr>
                            <td>
                                <sup>*</sup><label for="firstname">First Name</label>
                            </td>
                            <td>
                                <input type="text" id="firstname" required placeholder="required" name="firstname"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label for="lastname">Last Name</label>
                            </td>
                            <td>
                                <input type="text" name="lastname" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label for="number">Phone Number</label>
                            </td>
                            <td>
                                <input type="text" name="number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <sup>*</sup><label for="email">E-Mail</label>
                            </td>
                            <td>
                                <input type="email" id="email" required placeholder="required" name="email"
                                       pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}" />
                                    <span id="email-error" class="email-error"></span>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <sup>*</sup><label for="message">Message</label>
                            </td>
                            <td>
                                <textarea id="messagebox" required placeholder="required" class="maxlength" maxlength="300" name="message"></textarea>
                            </td>
                        </tr>
                    </table>
                    <button type="submit" id="submitbutton" name="submit">Send</button>
                    <button type="reset">Reset Form</button>
                </form>
            </main>
            <script>
                $(document).ready(function () {
                    $('#copyright-year').text('©' + new Date().getFullYear());

                    // Dynamic scroll stop: do not scroll past the form buttons (Send/Reset)
                    (function () {
                        var $stop = $('#contact_form');
                        if (!$stop.length) return;
                        function getMaxScrollY() {
                            var rect = $stop[0].getBoundingClientRect();
                            return rect.bottom + window.scrollY - window.innerHeight;
                        }
                        function clampScroll() {
                            var maxY = getMaxScrollY();
                            if (maxY > 0 && window.scrollY > maxY) window.scrollTo(0, maxY);
                        }
                        $(window).on('scroll', clampScroll).on('resize', clampScroll);
                    })();

                    $('#chatbubble, #chatbubble2, #chatbubble3, #chatbubble4, #chatbubble5, #chatbubble6').css('display', 'block');
                    requestAnimationFrame(function () {
                        $('#chatbubble').addClass('chatbubble_animate');
                        $('#chatbubble2').addClass('chatbubble2_animate');
                        $('#chatbubble3').addClass('chatbubble3_animate');
                        $('#chatbubble4').addClass('chatbubble4_animate');
                        $('#chatbubble5').addClass('chatbubble5_animate');
                        $('#chatbubble6').addClass('chatbubble6_animate');
                    });

                    //Site navigation and animation
                    $('.nav_page1').css({ 'left': '-180px', 'opacity': '1' });
                    $('.imageContainer1').css('opacity', '1');

                    $('.genesis').on('click', function (e) {
                        navigateTo('genesis.html', '#F5E10E');
                    });

                    $('.session').on('click', function (e) {
                        navigateTo('session.html', '#1D5F89');
                    });

                    $('.narrative').on('click', function (e) {
                        navigateTo('narrative.html', '#0E1037');
                    });

                    //remaining letters in message
                    $('.maxlength').after('<span class="remaining">').next().hide().end().keydown(function (event) {
                        var current = $(this).val().length;
                        if (current >= 300) {
                            if (event.which != 0 && event.which !== 8) {
                                event.preventDefault();
                            }
                        }
                        $(this).next().show().text('Rem.' + (300 - current));
                    })

                    //remaining counter hides when reset is activated
                    $('button:reset').on('click', function () {
                        $('.remaining').hide();
                        $('#email-error').text('');
                    });

                    // Email validation (same regex as in connect.css comment and HTML pattern)
                    var emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
                    var $emailInput = $('#email');
                    var $emailError = $('#email-error');

                    function validateEmail() {
                        var val = $emailInput.val().trim();
                        if (val.length === 0) {
                            $emailError.text('');
                            return true;
                        }
                        if (!emailRegex.test(val)) {
                            $emailError.text('Please enter a valid e-mail address.');
                            return false;
                        }
                        $emailError.text('');
                        return true;
                    }

                    $emailInput.on('blur', validateEmail);
                    $emailInput.on('input', function () {
                        if ($emailError.text()) validateEmail();
                    });

                    $('#contact_form').on('submit', function (e) {
                        if (!validateEmail()) {
                            e.preventDefault();
                            return false;
                        }
                    });

                    //eval

                    $('#submitbutton').on('submit',function(){
                        $.ajax({
                            type: 'POST',
                            url: 'validation.php',
                            success: function(msg){
console.log(msg);
                            }
                        })
                    });

                    if (window.innerWidth >= 960) {
                        $('.nav_page4 ul li').not(':nth-child(4)').find('a').on('mouseenter', function () {
                            $(this).addClass('nav-desktop-hover');
                        }).on('mouseleave', function () {
                            $(this).removeClass('nav-desktop-hover');
                        });
                    }
                });
            </script>
        </div>
        <nav class="nav_page4">
            <ul>
                <li><a class="genesis">genesis</a></li>
                <li><a class="session">session</a></li>
                <li><a class="narrative">narrative</a></li>
                <li><a style="color: #553E95;cursor:default;">connect</a></li>
            </ul>
        </nav>
    </div>
</body>